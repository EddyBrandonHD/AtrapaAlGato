<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <title>
      Jueguito Atrapa al Gato
    </title>
        <style>
      
      .sprite {
        position: fixed;
        font-size: 3rem;
      }
      body {
        background-image:
          url(https://deplanosycasas.com/wp-content/uploads/2016/02/Planos-casa-moderna.jpg);
        background-position-x:
          center;
        background-position-y:
          center;
        background-attachment:
          fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        
      }
      a {
        color: yellow;
      }
      h1 {
  color: #160256;
  text-shadow: #555 2px 2px 3px;
}
            p {
        color: #120409;
      }


    </style>
  </head>

  
  <body>
    <script>

        class FiguraWeb
          extends HTMLElement {
          connectedCallback() {
            this.style.position =
          "fixed";
        this.style.fontSize =
          "2.5rem";
        this.style.left =
          `${this.x}px`;
        this.style.top =
          `${this.y}px`;

          }
        }

        customElements.define(
          "figura-web", FiguraWeb);
      </script>


    <div class="modal fade" id="inicioJuego" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">ATRAPA EL GATO By. Brandon Villanueva</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Instruciones: <br>
          -Ingresar tu nombre(Primera letra Mayuscula). <br>
          -Dar click al boton iniciar juego <br>
          -Para moverse utilizar las flechas del lado superior derecho. <br>
           -Una vez iniciado el juego empezara a contar el tiempo, tienes que generar el mayor puntaje en un tiempo de 60 segundos, cuando el 
            contador llegue a 60 segundos automaticamente terminara tu partida. <br>
            -Para generar puntos el perro tiene que tocar al gato el mayor tiempo posible.
            
            <br><br>
            <div class="form-group">
              <input type="text" class="form-control nombres" id="nombres" 
                    name="nombre" placeholder="Ingresa tu nombre *" maxlength="35"> 
                    <p id="nomvali"></p>
                  </div>  
            <br><br>
            <center>
              &copy; 2021
              Villanueva Barboza Brandon Eduardo | ITIC-901M.
            </center>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            <button type="button"  class="btn btn-danger" id="">Puntajes</button>
            <button type="button"  class="btn btn-primary" data-dismiss="modal" onclick="ocultar()" id="iniciarS">Iniciar Juego</button>
          </div>
        </div>
      </div>
    </div>

  	<center>
    <h1>Atrapa al Gato By Brandon Villanueva</h1>
    
    <h4 id="temporizador"></h3>
    <h4 id="acumu"> </h2>
    <button type="button" class="btn btn-primary btn-lg active" id='idmodal'data-toggle="modal" data-target="#inicioJuego">
      Instrucciones | Iniciar Juego
    </button>
    <br>
    <br>
    <strong><h2 id="ganador"></h2></strong>
    <br><br><br>
    <button type="button" class="btn btn-danger btn-lg active" id='idReiniciar' onclick="reiniciar()">
      Reiniciar Juego
    </button>
    
    </center>
    <p style="text-align:right" id="atras">
      <button onclick="retrocede();">
        ü¢Ä
      </button>
      <button onclick="avanza();">
        ü¢Ç
      </button>
    </p>
        <p style="text-align:right" id="adelante">
      <button onclick="sube();">
        ü¢Å
      </button>
      <button onclick="baja();">
        ü¢É
      </button>
    </p>
    <footer >

    </footer>
    <figura-web class="sprite" id="perro">
      üê∂
    </figura-web>
    
    <figura-web class="sprite" id="gato">
      üê±
    </figura-web>


    

    <script>

      
      const VELOCIDAD = 40;
      let yBase, xMenor, xMayor;
      actualiza();
      let x = xMenor;
      let y = xMenor;
      dibuja();


      function sube() {
        actualiza();
        if (y > xMenor) {
          y -= VELOCIDAD;
        
        }
        dibuja();
      }
      function baja() {
        actualiza();
        if (y < xMayor) {
          y += VELOCIDAD;
        }
        dibuja();
      }
      function retrocede() {
        actualiza();
        if (x > xMenor) {
          x -= VELOCIDAD;
        }
        dibuja();
      }
      function avanza() {
        actualiza();
        if (x < xMayor) {
          x += VELOCIDAD;
        }
        dibuja();
      }
      function actualiza() {
          xMenor =
          window.innerWidth / 6;
         xMayor =
          4 * window.innerWidth / 5;
        yBase =
          window.innerHeight / 2;

      }
      function dibuja() {
        perro.style =
          `left: ${x}px; bottom: ${yBase}px; top: ${y}px;`;
      }


      function seTocan(e1, e2) {
        const rE1 =
          e1.getBoundingClientRect();
        const rE2 =
          e2.getBoundingClientRect();
        return (rE1.right >= rE2.left &&
          rE1.left <= rE2.right &&
          rE1.top <= rE2.bottom &&
          rE1.bottom >= rE2.top);
      }
var cronometro;
function detenerse(){
clearInterval(cronometro);
    }
let temporizador = document.getElementById('temporizador')
let iniciar = document.getElementById("iniciarS");
let tiempo = 0, intervalo = 0; movimiento = 0;
let verificador = false;
init();



function init(){
  iniciar.addEventListener('click', iniciarContador);
}



function iniciarContador(){

  const nombre = $("#nombres").val();
var patronletras=/^[A-Z√Å√â√ç√ì√ö√ë]{1}?[A-Za-z√°√©√≠√≥√∫√±√º√†√®√Å√â√ç√ì√ö√ë\s']*$/;
if(nombre.length==""){
          $('#nomvali').html("<p class='text-center' style='color:red;' ><i class='fas fa-times'></i> Campo requerido </p>").show();
          return false;
        }else if(nombre.search(patronletras)){
           $('#nomvali').html("<p class='text-center' style='color:red;'><i class='fas fa-times'></i> Debe empezar la primera letra con may√∫scula</p>").show();
           
           return false;
        }else{
          $('#nomvali').html("<p class='text-center' style='color:green;'><i class=' fas fa-check'></i> Formato correcto</p>").show();
          
         
        }

        
    var elemento = document.getElementById('idmodal').style.display = "none";
    

  const recargo = 10;
      const vel = 1.2;
      const frecuencia = 0.03;
      let varx = 0;
      movimiento = setInterval(
        muevete, recargo);
        var acumulador = 0;
      function muevete() {
        
        const maxima =
          window.innerWidth;
        const amplitud =
          window.innerHeight / 3;
        const base =
          window.innerHeight / 2;
        vary = base +
          amplitud * Math.sin(frecuencia * varx);
        gato.style =
          `left: ${varx}px; bottom: ${vary}px`;
        varx =
          (varx + vel) % maxima;

          if (seTocan(perro, gato)) {
          gato.value = "‚ö∞Ô∏è";
          acumulador = acumulador + 1;
          var puntos = 'PUNTAJE ACUMULADO: ' + acumulador;
          var objetivo = document.getElementById('acumu').innerHTML = puntos;
        } else {
           gato.value = "üê±";
        }
      }
  if(verificador==false){
    intervalo = setInterval(function(){
      tiempo += 0.01;
      temporizador.innerHTML = tiempo.toFixed(2);
    }, 10);
    verificador = true;
  } else {
    verificador = false;
    clearInterval(intervalo);
  }
  var texto = nombre + " GRACIAS POR JUGAR EL JUEGO ATRAPA AL GATO, PUEDES VOLVER A JUGAR Y SUPERAR TU PUNTUACION";
  ganador.style.
            backgroundColor = "red";
    timout=setTimeout(function(){
      clearInterval(movimiento);
      clearInterval(intervalo);
      var mues = document.getElementById('ganador').innerHTML = texto;
      alert("Tu tiempo se acabo, tu puntaje obtenido es de: " + acumulador + " puntos" );
      
var gatito = document.getElementById('gato').style.display = "none";
var perrito = document.getElementById('perro').style.display = "none";
var atras = document.getElementById('atras').style.display = "none";
var adelante = document.getElementById('adelante').style.display = "none";
var reset = document.getElementById('idReiniciar').style.display = "block";
    },6000);

    var gatito = document.getElementById('gato').style.display = "block";
var perrito = document.getElementById('perro').style.display = "block";
var atras = document.getElementById('atras').style.display = "block";
var adelante = document.getElementById('adelante').style.display = "block";


  }

  function grabarContenedor(){
    let p = document.createElement('ul');
    p.innerHTML = `<li>Tiempo : ${tiempo.toFixed(2)} <li>`;
      alamacenarTiempo.appedChild(p)
  }


  var adelante = document.getElementById('idReiniciar').style.display = "none";
var gatito = document.getElementById('gato').style.display = "none";
var perrito = document.getElementById('perro').style.display = "none";
var atras = document.getElementById('atras').style.display = "none";
var adelante = document.getElementById('adelante').style.display = "none";

function reiniciar(){
  location.reload();
}
setInterval(() => {
    gatoweb.mu√©vete();
      }, 120);

    </script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
  </body>
</html>